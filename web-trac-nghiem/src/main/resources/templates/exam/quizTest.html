<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>LHTransport-2021</title>
    <link rel="icon" href=
            "data:image/jpeg;base64,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"
          type="image/x-icon">
    <link rel="stylesheet" th:href="@{../../css/bootstrap.css} ">
    <link rel="stylesheet" th:href="@{../../css/page1.css}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link th:rel="stylesheet" th:href="@{../../assets/styles/custom.css} "/>
    <link rel="stylesheet" th:href="@{../../style/quiz.css}">
    <title>Trắc nghiệm Codegym</title>
</head>
<body>

<div th:insert="~{/default-page :: navbar}"></div>

<div class="container py-5 px-4">
    <div class="align-content-lg-center">
        <div class="col-lg-12 mt-2">
            <div class="rounded bg-gradient text-white shadow p-5 text-center mb-5">
                <p class="mb-0 font-weight-bold text-uppercase">Thời Gian Làm Bài:</p>
                <div id="clock" class="countdown pt-4"></div>
            </div>
        </div>
    </div>
    <h1 class="bg-info text-light"><span th:text="${ 'Đề thi gồm có '+qForm.questions.size()}+' câu'"></span><br>

        Mời Bạn Chọn Đáp Án Đúng
    </h1>

    <form th:action="@{/submit1/{id}(id=${idExam})}" method="POST" th:object="${qForm}" id="formQuestion">
        <input type="hidden" th:value="${idExam}" id="idExam">
        <input type="hidden" th:value="${userName}" id="nameuser">
        <div class="ques-box bg-dark text-light" th:each="ques, i: ${qForm.questions}">
            <p class="title" th:text="${'Câu '+i.count+': '+ ques.title}"></p>

            <div class="option">
                <input type="radio" th:name="|questions[${i.index}].chose|" th:value="1"/>
                <p th:text="|A. ${ques.optionA}|"></p>
            </div>

            <div class="option">
                <input type="radio" th:name="|questions[${i.index}].chose|" th:value="2"/>
                <p th:text="|B. ${ques.optionB}|"></p>
            </div>

            <div class="option">
                <input type="radio" th:name="|questions[${i.index}].chose|" th:value="3"/>
                <p th:text="|C. ${ques.optionC}|"></p>
            </div>
            <div class="option">
                <input type="radio" th:name="|questions[${i.index}].chose|" th:value="4"/>
                <p th:text="|D. ${ques.optionD}|"></p>
            </div>
            <input type="hidden" th:name="|questions[${i.index}].quesId|" th:value="${ques.quesId}"/>
            <input type="hidden" th:name="|questions[${i.index}].title|" th:value="${ques.title}"/>
            <input type="hidden" th:name="|questions[${i.index}].ans|" th:value="${ques.ans}"/>
            <p class="alert alert-danger d-none" th:id="${'alert' + i.index}" role="alert">
                Hãy chọn một đáp án
            </p>
        </div>
        <input type="hidden" id="time" value="1">
        <button type="submit" class="btn btn-info d-block mx-auto mt-4">Nộp bài</button>
    </form>
</div>
<!-- Importing Footer -->
<div class="page-footer" id="footer">
    <p CLASS="text-area text-light">@Codegym.vn - 2021</p>
</div>
<script th:src="@{../../jquery/jquery-3.5.1.min.js}"></script>
<script th:src="@{../../js/bootstrap.bundle.min.js}"></script>
<script th:src="@{../../js/popper.min.js}"></script>
<script th:src="@{../../js/bootstrap.js}"></script>
<script th:src="@{../../assets/jquery-countdown/jquery.countdown.min.js}"></script>
<script th:inline="javascript">
    $(document).ready(function () {
        let futureValue = [[${#calendars.format(futureDate,'yyyy/MM/dd HH:mm:ss')}]];
        let futureDate = new Date(futureValue.toString())
        countdown();

        function countdown() {
            let now = new Date().getTime();
            let distance = futureDate - now;
            // let days = Math.floor(distance / (1000 * 60 * 60 * 24));
            // let hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            let minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            let seconds = Math.floor((distance % (1000 * 60)) / 1000);
            let display = (minutes < 10 ? '0' + minutes : '' + minutes) + ':' + (seconds < 10 ? '0' + seconds : '' + seconds);
            $('#clock').text(display);
            if (minutes <= 0) {
                $('#clock').addClass('text-danger');

            }

            if (seconds <= 0 && minutes <= 0) {
                clearInterval(timer);
                document.getElementById("time").value = 0;
                $('#formQuestion').submit();
            }
        }

        $("#formQuestion").submit(function (event) {
            // event.preventDefault();
            var time = document.getElementById("time").value;
            if (time == 0) {
                return true;
            } else {
                let isSubmit = true;
                let listQuestion = $('.ques-box');
                for (let i = 0; i < listQuestion.length; i++) {
                    let answer = listQuestion[i].childNodes;
                    let statusCheck = false;
                    for (let k = 0; k < answer.length; k++) {
                        let check = true;
                        if (answer[k].nodeName === 'DIV') {
                            let option = answer[k].childNodes;
                            for (let j = 0; j < option.length; j++) {
                                if (option[j].nodeName === 'INPUT') {
                                    if (option[j].checked === true) {
                                        break;
                                    }
                                    check = false;
                                }
                            }
                            if (check) {
                                statusCheck = true;
                                break;
                            }
                        }
                    }
                    if (!statusCheck) {
                        listQuestion[i].querySelector('#alert' + i).classList.add('d-block')
                        listQuestion[i].querySelector('#alert' + i).classList.remove('d-none')
                        isSubmit = false;
                    } else {
                        listQuestion[i].querySelector('#alert' + i).classList.remove('d-block')
                        listQuestion[i].querySelector('#alert' + i).classList.add('d-none')
                    }
                    statusCheck = true;
                }
                if (!isSubmit) {
                    event.preventDefault();
                }
            }
        })

        let timer = setInterval(function () {
            countdown();
        }, 1000);
    })

    // $('#clock').countdown(endDate).on('update.countdown', function (event) {
    //     var $this = $(this).html(event.strftime(''
    //         + '<span class="h1 font-weight-bold">%D</span> Day%!d'
    //         + '<span class="h1 font-weight-bold">%H</span> Hr'
    //         + '<span class="h1 font-weight-bold">%M</span> Min'
    //         + '<span class="h1 font-weight-bold">%S</span> Sec'));
    //     console.log('<span class="h1 font-weight-bold">%M</span> Min');
    // });

        //
        // $(window).bind("beforeunload", function (event) {
        //     var id = document.getElementById("idExam").value;
        //     var user = document.getElementById("nameuser").value;
        //     var str= "/submit1/"+id;
        //     var str1= "/quiz1/"+user+"/"+id;
        // if (window.location.pathname != str && window.location.pathname!=str1 ) {
        //         return "You have unsaved changes";
        // }else {
        //     window.onbeforeunload=false;
        // }
        //
        // });
    // window.onbeforeunload = function() {
    //     var id = document.getElementById("idExam").value;
    //     var user = document.getElementById("nameuser").value;
    //     var str= "/submit1/"+id;
    //     var str1= "/quiz1/"+user+"/"+id;
    //     if (window.location.pathname != str && window.location.pathname!=str1 ) {
    //         return 'Do you really want to discard all your data?';
    //     }
    // }


    // $('#a_exit').on("click", function(){
    //     $(window).unbind('beforeunload');
    // });
    // window.addEventListener('beforeunload', (event) => {
    //     // Cancel the event as stated by the standard.
    //     event.preventDefault();
    //     // Chrome requires returnValue to be set.
    //     event.returnValue = 'Dữ liệu sẽ không lưu nếu bạn rời đi anh ơi anh ở lại';
    // });


</script>


</body>
</html>